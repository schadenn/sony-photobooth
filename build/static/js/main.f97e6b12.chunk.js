(this["webpackJsonpsony-photobooth"]=this["webpackJsonpsony-photobooth"]||[]).push([[0],{117:function(t,e,n){"use strict";n.r(e);var o=n(0),i=n(46),c=n.n(i),r=(n(55),n(13)),l=(n(56),9e3),s=n(1);var u=function(t){var e=t.src,n=t.time,o=t.onDoneClick,i="http://localhost:".concat(l,"/photos/");return Object(s.jsxs)("div",{children:[Object(s.jsx)("img",{src:i+e,class:"scale",alt:"review",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:"2337"}}),Object(s.jsxs)("button",{id:"doneBtn",onClick:o,style:{height:"150px",width:"300px",position:"fixed",right:0,bottom:0,zIndex:"2338",fontSize:"3vw"},children:["Fertig (",Math.round(n/1e3),")"]})]})},a=n(47),h=n.n(a),f=n(50);n(112);var d=function(t){var e=t.files,n=t.onDoneClick,i=t.isReviewing,c=t.onOpenClick,u=Object(o.useState)(null),a=Object(r.a)(u,2),d=a[0],b=a[1],j="http://localhost:".concat(l,"/photos/"),p=e.map((function(t){return j+t})).map((function(t){return{src:t,thumbnail:t,thumbnailWidth:280,thumbnailHeight:174}}));return Object(s.jsx)(s.Fragment,{children:i?Object(s.jsxs)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",zIndex:"2337"},children:[d&&Object(s.jsx)("div",{style:{position:"absolute",width:"100%",height:"100%",top:"0",left:"0"},children:Object(s.jsx)(f.a,{images:p,index:d-1,canAutoPlay:!1,isMaximized:!0,shouldMinimizeOnSwipeDown:!0,hasSizeButton:!1,onSwipeEndDown:function(){b(null)}})}),Object(s.jsx)("div",{style:{width:"100vw"},children:Object(s.jsx)(h.a,{images:p.reverse(),enableImageSelection:!1,onClickThumbnail:function(t){return b(t+1)}})}),Object(s.jsx)("button",{id:"doneBtn",onClick:function(){b(null),n()},style:{height:"150px",width:"250px",position:"fixed",right:0,bottom:0,zIndex:"2338",fontSize:"3vw",cursor:"pointer"},children:"Fertig"})]}):Object(s.jsx)("div",{className:"flip",style:{position:"absolute",bottom:0,left:0,width:"200px",height:"200px",zIndex:"2337",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"2vw",backgroundImage:"url(".concat(j+e.slice(-1)[0],")"),backgroundSize:"cover",backgroundPosition:"center",cursor:"pointer"},onClick:c,id:"openManualPreview",children:Object(s.jsx)("p",{className:"flip",children:"Gallerie"})})})},b=n(49),j=Object(b.a)("http://localhost:4800");j.onAny((function(t,e,n){return console.log("HAPPENED",t,e,n)})),j.on("reload-box",(function(t){console.log("RELOADING THROUGH WEBSOCKET"),window.location.href=window.location.href})),window.WEBSOCKET1=j;var p=function(){var t=Object(o.useState)(""),e=Object(r.a)(t,2),n=e[0],i=e[1],c=Object(o.useState)([]),a=Object(r.a)(c,2),h=a[0],f=a[1],b=Object(o.useState)(5e3),p=Object(r.a)(b,2),O=p[0],g=p[1],w=Object(o.useState)(12e3),x=Object(r.a)(w,2),m=x[0],v=x[1],y=Object(o.useState)(!1),k=Object(r.a)(y,2),S=k[0],C=k[1],I=Object(o.useState)(!1),z=Object(r.a)(I,2),E=z[0],F=z[1],D=Object(o.useState)(!1),P=Object(r.a)(D,2),R=P[0],B=P[1],A=Object(o.useState)(!1),M=Object(r.a)(A,2),T=M[0],N=M[1],H=Object(o.useRef)([]),G=Object(o.useRef)([]),W=function(){fetch("http://localhost:".concat(l,"/getPhotos")).then((function(t){return t.json()})).then((function(t){return f(t.files)})).catch((function(t){return console.error("Failed to fetch",t)}))},J=Object(o.useCallback)((function(){setTimeout((function(){return B(!0)}),900),fetch("http://localhost:".concat(l,"/takePhoto")).then((function(t){return t.json()})).then((function(t){i(t.file),C(!1),setTimeout((function(){return B(!1)}),200),W()})).catch((function(t){return console.error("Failed to fetch",t)}))}),[]);return Object(o.useEffect)((function(){j.on("start-timer",(function(t){var e=t.time;g(1e3*e),G.current.push("websocket_controlled"),N(!0)})),j.on("time-left",(function(t){var e=t.time;return console.log("time-left",e)||g(1e3*e)})),j.on("end-timer",(function(){g(0)})),W()}),[]),Object(o.useEffect)((function(){n&&(T?N(!1):H.current.push(setInterval((function(){return v((function(t){return t-10}))}),10)))}),[n]),Object(o.useEffect)((function(){m||(H.current.forEach((function(t){return clearInterval(t)})),H.current=[],v(12e3),window.location.href=window.location.href)}),[m]),Object(o.useEffect)((function(){O<2e3&&C(!0),O%1e3||!O||fetch("http://localhost:3000/triggerFocus"),0===O&&(J(),G.current.filter((function(t){return"websocket_controlled"!==t})).forEach((function(t){return clearInterval(t)})),G.current=[],g(5e3))}),[O,J]),Object(s.jsxs)("div",{className:"App",style:{position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",left:0,top:0},children:[n&&m&&H.current.length?Object(s.jsx)(u,{src:n,time:m,onDoneClick:function(){v(0),window.location.href=window.location.href}}):null,h.length?Object(s.jsx)(d,{files:h,isReviewing:E,onOpenClick:function(){return F(!0)},onDoneClick:function(){return F(!1)}}):null,E?null:Object(s.jsxs)("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},onClick:function(t){["doneBtn","openManualPreview","startRec","stopRec"].includes(t.target.id)||G.current.push(setInterval((function(){return g((function(t){return t-10}))}),10))},children:[!1,Object(s.jsx)("div",{style:{zIndex:"1337",width:"100%",height:"150px",backgroundColor:"rgba(0,0,0,0.3)",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(s.jsx)("p",{style:{fontSize:"5vw"},children:(R?"Foto kommt sofort":S&&"L\xe4cheln bitte :)")||!G.current.length&&"\ud83d\udc46 Antippen f\xfcr ein Foto \ud83d\udc46"||Math.round(O/1e3)})}),!R&&Object(s.jsx)("img",{class:"videoStream",src:"http://localhost:".concat(l,"/startViewFinder"),alt:"video stream",style:{width:"100%",height:"100%",position:"absolute",left:0,top:0,zIndex:"0"}})]})]})};c.a.render(Object(s.jsx)(p,{}),document.getElementById("root"))},55:function(t,e,n){},56:function(t,e,n){}},[[117,1,2]]]);
//# sourceMappingURL=main.f97e6b12.chunk.js.map