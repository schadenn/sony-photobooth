{"version":3,"sources":["constants.js","components/ImageReview/index.js","components/ShotsReview/index.js","App.js","index.js"],"names":["SERVER_PORT","ImageReview","src","time","onDoneClick","srcPrefix","window","location","hostname","class","alt","style","position","top","left","width","height","zIndex","id","onClick","right","bottom","fontSize","Math","round","ShotsReview","files","onDone","isReviewing","onOpenClick","useState","detailed","setDetailed","images","map","thumbnail","thumbnailWidth","thumbnailHeight","display","index","canAutoPlay","isMaximized","shouldMinimizeOnSwipeDown","hasSizeButton","onSwipeEndDown","reverse","enableImageSelection","onClickThumbnail","cursor","className","justifyContent","alignItems","backgroundImage","slice","backgroundSize","backgroundPosition","App","photoSrc","setPhotoSrc","shots","setShots","shotTimer","setShotTimer","reviewTimer","setReviewTimer","takingPhoto","setTakingPhoto","manualReview","setManualReview","loading","setLoading","noReview","setNoReview","reviewInterval","useRef","shotInterval","ip","fetchPhotos","fetch","then","res","json","catch","e","console","error","takePhoto","useCallback","setTimeout","file","useEffect","current","push","setInterval","oldValue","forEach","interval","clearInterval","href","filter","length","ev","includes","target","backgroundColor","ReactDOM","render","document","getElementById"],"mappings":"qNAAaA,G,MAAc,K,OCuCZC,MArCf,YAAkD,IAA3BC,EAA0B,EAA1BA,IAAKC,EAAqB,EAArBA,KAAMC,EAAe,EAAfA,YAC1BC,EAAS,iBAAaC,OAAOC,SAASC,SAA7B,YAAyCR,EAAzC,YAEf,OACE,gCACE,qBACEE,IAAKG,EAAYH,EACjBO,MAAM,QACNC,IAAI,SACJC,MAAO,CACLC,SAAU,WACVC,IAAK,EACLC,KAAM,EACNC,MAAO,OACPC,OAAQ,OACRC,OAAQ,UAGZ,yBACEC,GAAG,UACHC,QAASf,EACTO,MAAO,CACLK,OAAQ,QACRD,MAAO,QACPH,SAAU,QACVQ,MAAO,EACPC,OAAQ,EACRJ,OAAQ,OACRK,SAAU,OAVd,qBAaWC,KAAKC,MAAMrB,EAAO,KAb7B,W,+BC6FSsB,MA3Gf,YAAgF,IAAzDC,EAAwD,EAAxDA,MAAoBC,EAAoC,EAAjDvB,YAAqBwB,EAA4B,EAA5BA,YAAaC,EAAe,EAAfA,YAAe,EAC7CC,mBAAS,MADoC,mBACtEC,EADsE,KAC5DC,EAD4D,KAOvE3B,EAAS,iBAAaC,OAAOC,SAASC,SAA7B,YAAyCR,EAAzC,YACTiC,EAASP,EACZQ,KAAI,SAAChC,GAAD,OAASG,EAAYH,KACzBgC,KAAI,SAAChC,GAAD,MAAU,CACbA,MACAiC,UAAWjC,EACXkC,eAAgB,IAChBC,gBAAiB,QAGrB,OACE,mCACGT,EACC,sBACEjB,MAAO,CACLC,SAAU,WACVC,IAAK,EACLC,KAAM,EACNC,MAAO,OACPC,OAAQ,OACRsB,QAAS,OACTrB,OAAQ,QARZ,UAWGc,GACC,qBACEpB,MAAO,CACLC,SAAU,WACVG,MAAO,OACPC,OAAQ,OACRH,IAAK,IACLC,KAAM,KANV,SASE,cAAC,IAAD,CACEmB,OAAQA,EACRM,MAAOR,EAAW,EAClBS,aAAa,EACbC,aAAW,EACXC,2BAA2B,EAC3BC,eAAe,EACfC,eAAgB,WACdZ,EAAY,WAKpB,qBAAKrB,MAAO,CAAEI,MAAO,SAArB,SACE,cAAC,IAAD,CACEkB,OAAQA,EAAOY,UACfC,sBAAsB,EACtBC,iBAAkB,SAACR,GAAD,OAAWP,EAAYO,EAAQ,QAGrD,wBACErB,GAAG,UACHC,QA5DU,WAClBa,EAAY,MACZL,KA2DQhB,MAAO,CACLK,OAAQ,QACRD,MAAO,QACPH,SAAU,QACVQ,MAAO,EACPC,OAAQ,EACRJ,OAAQ,OACRK,SAAU,MACV0B,OAAQ,WAXZ,uBAkBF,qBACEC,UAAU,OACVtC,MAAO,CACLC,SAAU,WACVS,OAAQ,EACRP,KAAM,EACNC,MAAO,QACPC,OAAQ,QACRC,OAAQ,OACRqB,QAAS,OACTY,eAAgB,SAChBC,WAAY,SACZ7B,SAAU,MACV8B,gBAAgB,OAAD,OAAS/C,EAAYqB,EAAM2B,OAAO,GAAG,GAArC,KACfC,eAAgB,QAChBC,mBAAoB,SACpBP,OAAQ,WAEV7B,QAASU,EACTX,GAAG,oBAnBL,SAqBE,mBAAG+B,UAAU,OAAb,2BC2HKO,MA7Nf,WAAgB,IAAD,EACmB1B,mBAAS,IAD5B,mBACN2B,EADM,KACIC,EADJ,OAEa5B,mBAAS,IAFtB,mBAEN6B,EAFM,KAECC,EAFD,OAGqB9B,mBHRZ,KGKT,mBAGN+B,EAHM,KAGKC,EAHL,OAIyBhC,mBHVd,MGMX,mBAINiC,EAJM,KAIOC,EAJP,OAKyBlC,oBAAS,GALlC,mBAKNmC,EALM,KAKOC,EALP,OAM2BpC,oBAAS,GANpC,mBAMNqC,EANM,KAMQC,EANR,OAOiBtC,oBAAS,GAP1B,mBAONuC,EAPM,KAOGC,EAPH,OAQmBxC,oBAAS,GAR5B,mBAQNyC,EARM,KAQIC,EARJ,KASPC,EAAiBC,iBAAO,IACxBC,EAAeD,iBAAO,IACtBE,EAAKtE,OAAOC,SAASC,SAErBqE,EAAc,WAClBC,MAAM,UAAD,OAAWF,EAAX,YAAiB5E,EAAjB,eACF+E,MAAK,SAACC,GAAD,OAASA,EAAIC,UAClBF,MAAK,SAACC,GAAD,OAASpB,EAASoB,EAAItD,UAC3BwD,OAAM,SAACC,GAAD,OAAOC,QAAQC,MAAM,kBAAmBF,OAwB7CG,EAAYC,uBAAY,WAC5BC,YAAW,kBAAMlB,GAAW,KAAO,KACnCQ,MAAM,UAAD,OAAWF,EAAX,YAAiB5E,EAAjB,eACF+E,MAAK,SAACC,GAAD,OAASA,EAAIC,UAClBF,MAAK,SAACC,GACLtB,EAAYsB,EAAIS,MAChBvB,GAAe,GACfsB,YAAW,kBAAMlB,GAAW,KAAQ,KACpCO,OAEDK,OAAM,SAACC,GAAD,OAAOC,QAAQC,MAAM,kBAAmBF,QAChD,IAqDH,OAnDAO,qBAAU,WAaRb,MACC,IAEHa,qBAAU,WACJjC,IACEc,EACFC,GAAY,GAEZC,EAAekB,QAAQC,KACrBC,aAAY,kBAAM7B,GAAe,SAAC8B,GAAD,OAAcA,EAAW,QAAK,QAIpE,CAACrC,IAEJiC,qBAAU,WACH3B,IACHU,EAAekB,QAAQI,SAAQ,SAACC,GAAD,OAAcC,cAAcD,MAC3DvB,EAAekB,QAAU,GACzB3B,EH5FoB,MG6FpB1D,OAAOC,SAAS2F,KAAO5F,OAAOC,SAAS2F,QAExC,CAACnC,IAEJ2B,qBAAU,WACJ7B,EAAY,KAAMK,GAAe,GAC/BL,EAAY,MAASA,GACzBiB,MAAM,UAAD,OAAWF,EAAX,YAAiB5E,EAAjB,kBACW,IAAd6D,IACFyB,IACAX,EAAagB,QACVQ,QAAO,SAACjF,GAAD,MAAe,yBAAPA,KACf6E,SAAQ,SAACC,GAAD,OAAcC,cAAcD,MACvCrB,EAAagB,QAAU,GACvB7B,EH1GkB,QG4GnB,CAACD,EAAWyB,IAGb,sBACErC,UAAU,MACVtC,MAAO,CACLC,SAAU,WACV0B,QAAS,OACTY,eAAgB,SAChBC,WAAY,SACZpC,MAAO,OACPC,OAAQ,OACRF,KAAM,EACND,IAAK,GAVT,UAaG4C,GAAYM,GAAeU,EAAekB,QAAQS,OACjD,cAAC,EAAD,CACElG,IAAKuD,EACLtD,KAAM4D,EACN3D,YAAa,WACX4D,EAAe,GACf1D,OAAOC,SAAS2F,KAAO5F,OAAOC,SAAS2F,QAGzC,KACHvC,EAAMyC,OACL,cAAC,EAAD,CACE1E,MAAOiC,EACP/B,YAAauC,EACbtC,YAAa,kBAAMuC,GAAgB,IACnChE,YAAa,kBAAMgE,GAAgB,MAEnC,KACFD,EA+EE,KA9EF,sBACExD,MAAO,CACLI,MAAO,OACPC,OAAQ,OACRsB,QAAS,OACTY,eAAgB,SAChBC,WAAY,UAEdhC,QAAS,SAACkF,GAEL,CAAC,UAAW,oBAAqB,WAAY,WAAWC,SACvDD,EAAGE,OAAOrF,KAGZyD,EAAagB,QAAQC,KACnBC,aAAY,kBAAM/B,GAAa,SAACgC,GAAD,OAAcA,EAAW,QAAK,MAfrE,WAoBG,EAuBD,qBACEnF,MAAO,CACLM,OAAQ,OACRF,MAAO,OACPC,OAAQ,QACRwF,gBAAiB,kBACjBlE,QAAS,OACTY,eAAgB,SAChBC,WAAY,UARhB,SAWE,mBAAGxC,MAAO,CAAEW,SAAU,OAAtB,UACI+C,EAAW,oBACVJ,GAAe,yBACdU,EAAagB,QAAQS,QACrB,sDACF7E,KAAKC,MAAMqC,EAAY,UAG3BQ,GACA,qBACE5D,MAAM,cACNP,IAAG,iBAAY0E,EAAZ,YAAkB5E,EAAlB,oBACHU,IAAI,eACJC,MAAO,CACLI,MAAO,OACPC,OAAQ,OACRJ,SAAU,WACVE,KAAM,EACND,IAAK,EACLI,OAAQ,cCrNxBwF,IAASC,OAAO,cAAC,EAAD,IAASC,SAASC,eAAe,W","file":"static/js/main.8f6411cb.chunk.js","sourcesContent":["export const SERVER_PORT = 9000\r\n\r\nexport const REVIEWTIME = 12000\r\nexport const SHOTTIME = 5000\r\n","import { SERVER_PORT } from \"../../constants\"\r\n\r\nfunction ImageReview({ src, time, onDoneClick }) {\r\n  const srcPrefix = `http://${window.location.hostname}:${SERVER_PORT}/photos/`\r\n\r\n  return (\r\n    <div>\r\n      <img\r\n        src={srcPrefix + src}\r\n        class=\"scale\"\r\n        alt=\"review\"\r\n        style={{\r\n          position: \"absolute\",\r\n          top: 0,\r\n          left: 0,\r\n          width: \"100%\",\r\n          height: \"100%\",\r\n          zIndex: \"2337\",\r\n        }}\r\n      />\r\n      <button\r\n        id=\"doneBtn\"\r\n        onClick={onDoneClick}\r\n        style={{\r\n          height: \"150px\",\r\n          width: \"300px\",\r\n          position: \"fixed\",\r\n          right: 0,\r\n          bottom: 0,\r\n          zIndex: \"2338\",\r\n          fontSize: \"3vw\",\r\n        }}\r\n      >\r\n        Fertig ({Math.round(time / 1000)})\r\n      </button>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ImageReview\r\n","import { useState } from \"react\"\r\nimport Gallery from \"react-grid-gallery\"\r\nimport Carousel from \"react-gallery-carousel\"\r\nimport \"react-gallery-carousel/dist/index.css\"\r\nimport { SERVER_PORT } from \"../../constants\"\r\n\r\nfunction ShotsReview({ files, onDoneClick: onDone, isReviewing, onOpenClick }) {\r\n  const [detailed, setDetailed] = useState(null)\r\n\r\n  const onDoneClick = () => {\r\n    setDetailed(null)\r\n    onDone()\r\n  }\r\n  const srcPrefix = `http://${window.location.hostname}:${SERVER_PORT}/photos/`\r\n  const images = files\r\n    .map((src) => srcPrefix + src)\r\n    .map((src) => ({\r\n      src,\r\n      thumbnail: src,\r\n      thumbnailWidth: 280,\r\n      thumbnailHeight: 174,\r\n    }))\r\n\r\n  return (\r\n    <>\r\n      {isReviewing ? (\r\n        <div\r\n          style={{\r\n            position: \"absolute\",\r\n            top: 0,\r\n            left: 0,\r\n            width: \"100%\",\r\n            height: \"100%\",\r\n            display: \"flex\",\r\n            zIndex: \"2337\",\r\n          }}\r\n        >\r\n          {detailed && (\r\n            <div\r\n              style={{\r\n                position: \"absolute\",\r\n                width: \"100%\",\r\n                height: \"100%\",\r\n                top: \"0\",\r\n                left: \"0\",\r\n              }}\r\n            >\r\n              <Carousel\r\n                images={images}\r\n                index={detailed - 1}\r\n                canAutoPlay={false}\r\n                isMaximized\r\n                shouldMinimizeOnSwipeDown={true}\r\n                hasSizeButton={false}\r\n                onSwipeEndDown={() => {\r\n                  setDetailed(null)\r\n                }}\r\n              />\r\n            </div>\r\n          )}\r\n          <div style={{ width: \"100vw\" }}>\r\n            <Gallery\r\n              images={images.reverse()}\r\n              enableImageSelection={false}\r\n              onClickThumbnail={(index) => setDetailed(index + 1)}\r\n            />\r\n          </div>\r\n          <button\r\n            id=\"doneBtn\"\r\n            onClick={onDoneClick}\r\n            style={{\r\n              height: \"150px\",\r\n              width: \"250px\",\r\n              position: \"fixed\",\r\n              right: 0,\r\n              bottom: 0,\r\n              zIndex: \"2338\",\r\n              fontSize: \"3vw\",\r\n              cursor: \"pointer\",\r\n            }}\r\n          >\r\n            Fertig\r\n          </button>\r\n        </div>\r\n      ) : (\r\n        <div\r\n          className=\"flip\"\r\n          style={{\r\n            position: \"absolute\",\r\n            bottom: 0,\r\n            left: 0,\r\n            width: \"200px\",\r\n            height: \"200px\",\r\n            zIndex: \"2337\",\r\n            display: \"flex\",\r\n            justifyContent: \"center\",\r\n            alignItems: \"center\",\r\n            fontSize: \"2vw\",\r\n            backgroundImage: `url(${srcPrefix + files.slice(-1)[0]})`,\r\n            backgroundSize: \"cover\",\r\n            backgroundPosition: \"center\",\r\n            cursor: \"pointer\",\r\n          }}\r\n          onClick={onOpenClick}\r\n          id=\"openManualPreview\"\r\n        >\r\n          <p className=\"flip\">Gallerie</p>\r\n        </div>\r\n      )}\r\n    </>\r\n  )\r\n}\r\n\r\nexport default ShotsReview\r\n","import { useState, useEffect, useRef, useCallback } from \"react\"\n\nimport \"./App.css\"\nimport ImageReview from \"./components/ImageReview\"\nimport ShotsReview from \"./components/ShotsReview\"\nimport { SHOTTIME, REVIEWTIME, SERVER_PORT } from \"./constants\"\n// import { socket } from \"./components/WebSocket\"\n\nfunction App() {\n  const [photoSrc, setPhotoSrc] = useState(\"\")\n  const [shots, setShots] = useState([])\n  const [shotTimer, setShotTimer] = useState(SHOTTIME)\n  const [reviewTimer, setReviewTimer] = useState(REVIEWTIME)\n  const [takingPhoto, setTakingPhoto] = useState(false)\n  const [manualReview, setManualReview] = useState(false)\n  const [loading, setLoading] = useState(false)\n  const [noReview, setNoReview] = useState(false)\n  const reviewInterval = useRef([])\n  const shotInterval = useRef([])\n  const ip = window.location.hostname\n\n  const fetchPhotos = () => {\n    fetch(`http://${ip}:${SERVER_PORT}/getPhotos`)\n      .then((res) => res.json())\n      .then((res) => setShots(res.files))\n      .catch((e) => console.error(\"Failed to fetch\", e))\n  }\n\n  const startRec = () => {\n    fetch(`http://${ip}:${SERVER_PORT}/startMovieRec`)\n      .then((res) => console.log(res) || res.json())\n      .then((res) => console.log(res))\n      .catch((e) => console.error(\"Failed to fetch\", e))\n  }\n\n  const stopRec = () => {\n    fetch(`http://${ip}:${SERVER_PORT}/stopMovieRec`)\n      .then((res) => console.log(res) || res.json())\n      .then((res) => console.log(res))\n      .catch((e) => console.error(\"Failed to fetch\", e))\n  }\n\n  const getEvent = () => {\n    fetch(`http://${ip}:${SERVER_PORT}/getEvent`)\n      .then((res) => console.log(res) || res.json())\n      .then((res) => console.log(res))\n      .catch((e) => console.error(\"Failed to fetch\", e))\n  }\n\n  const takePhoto = useCallback(() => {\n    setTimeout(() => setLoading(true), 900)\n    fetch(`http://${ip}:${SERVER_PORT}/takePhoto`)\n      .then((res) => res.json())\n      .then((res) => {\n        setPhotoSrc(res.file)\n        setTakingPhoto(false)\n        setTimeout(() => setLoading(false), 200)\n        fetchPhotos()\n      })\n      .catch((e) => console.error(\"Failed to fetch\", e))\n  }, [])\n\n  useEffect(() => {\n    // socket.on(\"start-timer\", ({ time }) => {\n    //   setShotTimer(time * 1000)\n    //   shotInterval.current.push(\"websocket_controlled\")\n    //   setNoReview(true)\n    // })\n    // socket.on(\n    //   \"time-left\",\n    //   ({ time }) => console.log(\"time-left\", time) || setShotTimer(time * 1000)\n    // )\n    // socket.on(\"end-timer\", () => {\n    //   setShotTimer(0)\n    // })\n    fetchPhotos()\n  }, [])\n\n  useEffect(() => {\n    if (photoSrc) {\n      if (noReview) {\n        setNoReview(false)\n      } else {\n        reviewInterval.current.push(\n          setInterval(() => setReviewTimer((oldValue) => oldValue - 10), 10)\n        )\n      }\n    }\n  }, [photoSrc])\n\n  useEffect(() => {\n    if (!reviewTimer) {\n      reviewInterval.current.forEach((interval) => clearInterval(interval))\n      reviewInterval.current = []\n      setReviewTimer(REVIEWTIME)\n      window.location.href = window.location.href\n    }\n  }, [reviewTimer])\n\n  useEffect(() => {\n    if (shotTimer < 2000) setTakingPhoto(true)\n    if (!(shotTimer % 1000) && shotTimer)\n      fetch(`http://${ip}:${SERVER_PORT}/triggerFocus`)\n    if (shotTimer === 0) {\n      takePhoto()\n      shotInterval.current\n        .filter((id) => id !== \"websocket_controlled\")\n        .forEach((interval) => clearInterval(interval))\n      shotInterval.current = []\n      setShotTimer(SHOTTIME)\n    }\n  }, [shotTimer, takePhoto])\n\n  return (\n    <div\n      className=\"App\"\n      style={{\n        position: \"absolute\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        width: \"100%\",\n        height: \"100%\",\n        left: 0,\n        top: 0,\n      }}\n    >\n      {photoSrc && reviewTimer && reviewInterval.current.length ? (\n        <ImageReview\n          src={photoSrc}\n          time={reviewTimer}\n          onDoneClick={() => {\n            setReviewTimer(0)\n            window.location.href = window.location.href\n          }}\n        />\n      ) : null}\n      {shots.length ? (\n        <ShotsReview\n          files={shots}\n          isReviewing={manualReview}\n          onOpenClick={() => setManualReview(true)}\n          onDoneClick={() => setManualReview(false)}\n        />\n      ) : null}\n      {!manualReview ? (\n        <div\n          style={{\n            width: \"100%\",\n            height: \"100%\",\n            display: \"flex\",\n            justifyContent: \"center\",\n            alignItems: \"center\",\n          }}\n          onClick={(ev) => {\n            if (\n              ![\"doneBtn\", \"openManualPreview\", \"startRec\", \"stopRec\"].includes(\n                ev.target.id\n              )\n            ) {\n              shotInterval.current.push(\n                setInterval(() => setShotTimer((oldValue) => oldValue - 10), 10)\n              )\n            }\n          }}\n        >\n          {false && (\n            <div\n              style={{\n                zIndex: \"1337\",\n                width: \"60%\",\n                height: \"150px\",\n                backgroundColor: \"rgba(0,0,0,0.3)\",\n                display: \"flex\",\n                justifyContent: \"center\",\n                alignItems: \"center\",\n              }}\n            >\n              <button id=\"startRec\" onClick={startRec}>\n                Start Rec\n              </button>\n              <button id=\"stopRec\" onClick={stopRec}>\n                Stop Rec\n              </button>\n              <button id=\"stopRec\" onClick={getEvent}>\n                Get Event\n              </button>\n            </div>\n          )}\n          <div\n            style={{\n              zIndex: \"1337\",\n              width: \"100%\",\n              height: \"150px\",\n              backgroundColor: \"rgba(0,0,0,0.3)\",\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\",\n            }}\n          >\n            <p style={{ fontSize: \"5vw\" }}>\n              {(loading && \"Foto kommt sofort\") ||\n                (takingPhoto && \"Lächeln bitte :)\") ||\n                (!shotInterval.current.length &&\n                  \"👆 Antippen für ein Foto 👆\") ||\n                Math.round(shotTimer / 1000)}\n            </p>\n          </div>\n          {!loading && (\n            <img\n              class=\"videoStream\"\n              src={`http://${ip}:${SERVER_PORT}/startViewFinder`}\n              alt=\"video stream\"\n              style={{\n                width: \"100%\",\n                height: \"100%\",\n                position: \"absolute\",\n                left: 0,\n                top: 0,\n                zIndex: \"0\",\n              }}\n            />\n          )}\n        </div>\n      ) : null}\n    </div>\n  )\n}\n\nexport default App\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport \"./index.css\"\nimport App from \"./App\"\n//import reportWebVitals from \"./reportWebVitals\"\n\nReactDOM.render(<App />, document.getElementById(\"root\"))\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n//reportWebVitals();\n"],"sourceRoot":""}