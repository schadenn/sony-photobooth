(this["webpackJsonpsony-photobooth"]=this["webpackJsonpsony-photobooth"]||[]).push([[0],{11:function(t,e,n){},12:function(t,e,n){},15:function(t,e,n){"use strict";n.r(e);var o=n(0),c=n(4),i=n.n(c),r=(n(11),n(2)),s=(n(12),9e3),l=n(1);var u=function(t){var e=t.src,n=t.time,c=t.onDoneClick,i=Object(o.useState)(),u=Object(r.a)(i,2),a=u[0],h=u[1],f="http://".concat(window.location.hostname,":").concat(s,"/photos/");return console.log("REVIEW",f+e),Object(o.useEffect)((function(){fetch(f+e).then((function(t){return t.blob()})).then((function(t){var e=new FileReader;e.readAsDataURL(t),e.onloadend=function(){h(e.result)}}))}),[]),Object(l.jsxs)("div",{children:[Object(l.jsx)("img",{src:a,class:"scale",alt:"review",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:"2337"}},n),Object(l.jsxs)("button",{id:"doneBtn",onClick:c,style:{height:"150px",width:"300px",position:"fixed",right:0,bottom:0,zIndex:"2338",fontSize:"3vw"},children:["Fertig (",Math.round(n/1e3),")"]})]})},a=n(6),h=n(5);n(14);var f=function(t){var e=t.files,n=t.onDoneClick,c=t.isReviewing,i=t.onOpenClick,u=Object(o.useState)(null),f=Object(r.a)(u,2),d=f[0],b=f[1],j="http://".concat(window.location.hostname,":").concat(s,"/photos/"),p=e.map((function(t){return j+t})).map((function(t){return{src:t,width:280,height:174}}));return Object(l.jsx)(l.Fragment,{children:c?Object(l.jsxs)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",zIndex:"2337"},children:[!!d&&Object(l.jsx)("div",{style:{position:"absolute",width:"100%",height:"100%",top:"0",left:"0"},children:Object(l.jsx)(h.a,{images:p,index:d-1,canAutoPlay:!1,isMaximized:!0,shouldMinimizeOnSwipeDown:!0,hasSizeButton:!1,onSwipeEndDown:function(){b(null)}})}),Object(l.jsx)("div",{style:{width:"100vw"},children:Object(l.jsx)(a.Gallery,{images:p.reverse(),enableImageSelection:!1,onClick:function(t){return b(t+1)}})}),Object(l.jsx)("button",{id:"doneBtn",onClick:function(){b(null),n()},style:{height:"150px",width:"250px",position:"fixed",right:0,bottom:0,zIndex:"2338",fontSize:"3vw",cursor:"pointer"},children:"Fertig"})]}):Object(l.jsx)("div",{className:"flip",style:{position:"absolute",bottom:0,left:0,width:"200px",height:"200px",zIndex:"2337",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"2vw",backgroundImage:"url(".concat(j+e.slice(-1)[0],")"),backgroundSize:"cover",backgroundPosition:"center",cursor:"pointer",color:"white"},onClick:i,id:"openManualPreview"})})};var d=function(){var t=Object(o.useState)(""),e=Object(r.a)(t,2),n=e[0],c=e[1],i=Object(o.useState)([]),a=Object(r.a)(i,2),h=a[0],d=a[1],b=Object(o.useState)(5e3),j=Object(r.a)(b,2),p=j[0],O=j[1],w=Object(o.useState)(12e3),g=Object(r.a)(w,2),x=g[0],v=g[1],m=Object(o.useState)(!1),y=Object(r.a)(m,2),k=y[0],I=y[1],S=Object(o.useState)(!1),C=Object(r.a)(S,2),z=C[0],E=C[1],F=Object(o.useState)(!1),R=Object(r.a)(F,2),D=R[0],M=R[1],P=Object(o.useState)(!1),B=Object(r.a)(P,2),A=B[0],L=B[1],V=Object(o.useRef)([]),J=Object(o.useRef)([]),N=window.location.hostname,T=function(){fetch("http://".concat(N,":").concat(s,"/getPhotos")).then((function(t){return t.json()})).then((function(t){return d(t.files)})).catch((function(t){return console.error("Failed to fetch",t)}))},G=Object(o.useCallback)((function(){setTimeout((function(){return M(!0)}),900),fetch("http://".concat(N,":").concat(s,"/takePhoto")).then((function(t){return t.json()})).then((function(t){console.log("photo done",t),c(t.file),I(!1),setTimeout((function(){return M(!1)}),200),T()})).catch((function(t){return console.error("Failed to fetch",t)}))}),[]);return Object(o.useEffect)((function(){T()}),[]),Object(o.useEffect)((function(){n&&(A?L(!1):V.current.push(setInterval((function(){return v((function(t){return t-1e3}))}),1e3)))}),[n]),Object(o.useEffect)((function(){x||(V.current.forEach((function(t){return clearInterval(t)})),V.current=[],v(12e3),window.location.href=window.location.href)}),[x]),Object(o.useEffect)((function(){p<2e3&&I(!0),p%1e3||!p||fetch("http://".concat(N,":").concat(s,"/triggerFocus")),0===p&&(G(),J.current.filter((function(t){return"websocket_controlled"!==t})).forEach((function(t){return clearInterval(t)})),J.current=[],O(5e3))}),[p,G]),Object(l.jsxs)("div",{className:"App",style:{position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",left:0,top:0},children:[n&&x&&V.current.length?Object(l.jsx)(u,{src:n,time:x,onDoneClick:function(){v(0),window.location.href=window.location.href}}):null,h.length?Object(l.jsx)(f,{files:h,isReviewing:z,onOpenClick:function(){return!console.log("CLICKED")&&E(!0)},onDoneClick:function(){return E(!1)}}):null,z?null:Object(l.jsxs)("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},onClick:function(t){["doneBtn","openManualPreview","startRec","stopRec"].includes(t.target.id)||J.current.push(setInterval((function(){return O((function(t){return t-1e3}))}),1e3))},children:[!1,Object(l.jsx)("div",{style:{zIndex:"1337",width:"100%",height:"150px",backgroundColor:"rgba(0,0,0,0.3)",display:"flex",justifyContent:"center",alignItems:"center",color:"white"},children:Object(l.jsx)("p",{style:{fontSize:"5vw"},children:(D?"Vorschau kommt sofort":k&&"L\xe4cheln bitte :)")||!J.current.length&&"\ud83d\udc46 Antippen f\xfcr ein Foto \ud83d\udc46"||Math.round(p/1e3)})}),!D&&Object(l.jsx)("img",{class:"videoStream",src:"http://".concat(N,":").concat(s,"/startViewFinder"),alt:"video stream",style:{width:"100%",height:"100%",position:"absolute",left:0,top:0,zIndex:0}})]})]})};i.a.render(Object(l.jsx)(d,{}),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.c91b9ebb.chunk.js.map